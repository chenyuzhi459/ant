webpackJsonp([5],{618:function(e,t,n){n(756);var r=n(310)(n(674),n(731),null,null);e.exports=r.exports},629:function(e,t,n){"use strict";function r(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=a(t),this.reject=a(n)}var a=n(309);e.exports.f=function(e){return new r(e)}},630:function(e,t,n){var r=n(136),a=n(51)("toStringTag"),o="Arguments"==r(function(){return arguments}()),s=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=s(t=Object(e),a))?n:o?r(t):"Object"==(i=r(t))&&"function"==typeof t.callee?"Arguments":i}},631:function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},632:function(e,t,n){var r=n(64),a=n(66),o=n(629);e.exports=function(e,t){if(r(e),a(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},633:function(e,t,n){var r=n(64),a=n(309),o=n(51)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||void 0==(n=r(s)[o])?t:a(n)}},634:function(e,t,n){var r,a,o,s=n(308),i=n(643),c=n(315),u=n(137),l=n(33),m=l.process,p=l.setImmediate,f=l.clearImmediate,d=l.MessageChannel,h=l.Dispatch,g=0,v={},S=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},b=function(e){S.call(e.data)};p&&f||(p=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++g]=function(){i("function"==typeof e?e:Function(e),t)},r(g),g},f=function(e){delete v[e]},"process"==n(136)(m)?r=function(e){m.nextTick(s(S,e,1))}:h&&h.now?r=function(e){h.now(s(S,e,1))}:d?(a=new d,o=a.port2,a.port1.onmessage=b,r=s(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):r="onreadystatechange"in u("script")?function(e){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),S.call(e)}}:function(e){setTimeout(s(S,e,1),0)}),e.exports={set:p,clear:f}},635:function(e,t,n){"use strict";t.__esModule=!0;var r=n(641),a=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(e){return function(){var t=e.apply(this,arguments);return new a.default(function(e,n){function r(o,s){try{var i=t[o](s),c=i.value}catch(e){return void n(e)}if(!i.done)return a.default.resolve(c).then(function(e){r("next",e)},function(e){r("throw",e)});e(c)}return r("next")})}}},636:function(e,t,n){e.exports=n(652)},637:function(e,t,n){var r=n(308),a=n(645),o=n(644),s=n(64),i=n(311),c=n(648),u={},l={},t=e.exports=function(e,t,n,m,p){var f,d,h,g,v=p?function(){return e}:c(e),S=r(n,m,t?2:1),b=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(o(v)){for(f=i(e.length);f>b;b++)if((g=t?S(s(d=e[b])[0],d[1]):S(e[b]))===u||g===l)return g}else for(h=v.call(e);!(d=h.next()).done;)if((g=a(h,S,d.value,t))===u||g===l)return g};t.BREAK=u,t.RETURN=l},638:function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},639:function(e,t,n){var r=n(53);e.exports=function(e,t,n){for(var a in t)n&&e[a]?e[a]=t[a]:r(e,a,t[a]);return e}},640:function(e,t,n){"use strict";var r=n(33),a=n(52),o=n(37),s=n(36),i=n(51)("species");e.exports=function(e){var t="function"==typeof a[e]?a[e]:r[e];s&&t&&!t[i]&&o.f(t,i,{configurable:!0,get:function(){return this}})}},641:function(e,t,n){e.exports={default:n(642),__esModule:!0}},642:function(e,t,n){n(312),n(313),n(314),n(649),n(650),n(651),e.exports=n(52).Promise},643:function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},644:function(e,t,n){var r=n(88),a=n(51)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[a]===e)}},645:function(e,t,n){var r=n(64);e.exports=function(e,t,n,a){try{return a?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},646:function(e,t,n){var r=n(51)("iterator"),a=!1;try{var o=[7][r]();o.return=function(){a=!0},Array.from(o,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!a)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},e(o)}catch(e){}return n}},647:function(e,t,n){var r=n(33),a=n(634).set,o=r.MutationObserver||r.WebKitMutationObserver,s=r.process,i=r.Promise,c="process"==n(136)(s);e.exports=function(){var e,t,n,u=function(){var r,a;for(c&&(r=s.domain)&&r.exit();e;){a=e.fn,e=e.next;try{a()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(c)n=function(){s.nextTick(u)};else if(o){var l=!0,m=document.createTextNode("");new o(u).observe(m,{characterData:!0}),n=function(){m.data=l=!l}}else if(i&&i.resolve){var p=i.resolve();n=function(){p.then(u)}}else n=function(){a.call(r,u)};return function(r){var a={fn:r,next:void 0};t&&(t.next=a),e||(e=a,n()),t=a}}},648:function(e,t,n){var r=n(630),a=n(51)("iterator"),o=n(88);e.exports=n(52).getIteratorMethod=function(e){if(void 0!=e)return e[a]||e["@@iterator"]||o[r(e)]}},649:function(e,t,n){"use strict";var r,a,o,s,i=n(92),c=n(33),u=n(308),l=n(630),m=n(65),p=n(66),f=n(309),d=n(638),h=n(637),g=n(633),v=n(634).set,S=n(647)(),b=n(629),_=n(631),y=n(632),w=c.TypeError,x=c.process,$=c.Promise,k="process"==l(x),D=function(){},C=a=b.f,T=!!function(){try{var e=$.resolve(1),t=(e.constructor={})[n(51)("species")]=function(e){e(D,D)};return(k||"function"==typeof PromiseRejectionEvent)&&e.then(D)instanceof t}catch(e){}}(),M=function(e){var t;return!(!p(e)||"function"!=typeof(t=e.then))&&t},R=function(e,t){if(!e._n){e._n=!0;var n=e._c;S(function(){for(var r=e._v,a=1==e._s,o=0;n.length>o;)!function(t){var n,o,s=a?t.ok:t.fail,i=t.resolve,c=t.reject,u=t.domain;try{s?(a||(2==e._h&&F(e),e._h=1),!0===s?n=r:(u&&u.enter(),n=s(r),u&&u.exit()),n===t.promise?c(w("Promise-chain cycle")):(o=M(n))?o.call(n,i,c):i(n)):c(r)}catch(e){c(e)}}(n[o++]);e._c=[],e._n=!1,t&&!e._h&&I(e)})}},I=function(e){v.call(c,function(){var t,n,r,a=e._v,o=z(e);if(o&&(t=_(function(){k?x.emit("unhandledRejection",a,e):(n=c.onunhandledrejection)?n({promise:e,reason:a}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",a)}),e._h=k||z(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},z=function(e){if(1==e._h)return!1;for(var t,n=e._a||e._c,r=0;n.length>r;)if(t=n[r++],t.fail||!z(t.promise))return!1;return!0},F=function(e){v.call(c,function(){var t;k?x.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})})},P=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),R(t,!0))},E=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw w("Promise can't be resolved itself");(t=M(e))?S(function(){var r={_w:n,_d:!1};try{t.call(e,u(E,r,1),u(P,r,1))}catch(e){P.call(r,e)}}):(n._v=e,n._s=1,R(n,!1))}catch(e){P.call({_w:n,_d:!1},e)}}};T||($=function(e){d(this,$,"Promise","_h"),f(e),r.call(this);try{e(u(E,this,1),u(P,this,1))}catch(e){P.call(this,e)}},r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n(639)($.prototype,{then:function(e,t){var n=C(g(this,$));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=k?x.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&R(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=u(E,e,1),this.reject=u(P,e,1)},b.f=C=function(e){return e===$||e===s?new o(e):a(e)}),m(m.G+m.W+m.F*!T,{Promise:$}),n(91)($,"Promise"),n(640)("Promise"),s=n(52).Promise,m(m.S+m.F*!T,"Promise",{reject:function(e){var t=C(this);return(0,t.reject)(e),t.promise}}),m(m.S+m.F*(i||!T),"Promise",{resolve:function(e){return y(i&&this===s?$:this,e)}}),m(m.S+m.F*!(T&&n(646)(function(e){$.all(e).catch(D)})),"Promise",{all:function(e){var t=this,n=C(t),r=n.resolve,a=n.reject,o=_(function(){var n=[],o=0,s=1;h(e,!1,function(e){var i=o++,c=!1;n.push(void 0),s++,t.resolve(e).then(function(e){c||(c=!0,n[i]=e,--s||r(n))},a)}),--s||r(n)});return o.e&&a(o.v),n.promise},race:function(e){var t=this,n=C(t),r=n.reject,a=_(function(){h(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return a.e&&r(a.v),n.promise}})},650:function(e,t,n){"use strict";var r=n(65),a=n(52),o=n(33),s=n(633),i=n(632);r(r.P+r.R,"Promise",{finally:function(e){var t=s(this,a.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return i(t,e()).then(function(){return n})}:e,n?function(n){return i(t,e()).then(function(){throw n})}:e)}})},651:function(e,t,n){"use strict";var r=n(65),a=n(629),o=n(631);r(r.S,"Promise",{try:function(e){var t=a.f(this),n=o(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},652:function(e,t,n){(function(t){var r="object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this,a=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=a&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,e.exports=n(316),a)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=void 0}}).call(t,n(90))},654:function(e,t,n){t=e.exports=n(89)(void 0),t.push([e.i,".click-link{cursor:pointer;color:#20a0ff}.click-link:link{color:blue;text-decoration:none}.click-link:active{color:#20a0ff}.click-link:visited{color:purple;text-decoration:none}.click-link:hover{text-decoration:underline}",""])},655:function(e,t,n){t=e.exports=n(89)(void 0),t.push([e.i,".popoverDiv{color:#20a0ff;font-size:15px;line-height:22px;font-weight:550}",""])},674:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(636),a=n.n(r),o=n(635),s=n.n(o),i=n(323),c=n.n(i);t.default={data:function(){return{dataSources:[],showTableData:[],dialogMessage:"",dialogTitle:"",dialogSize:"large",dialogInputAutosize:{},dialogVisible:!1,formInline:{name:""},pageSize:15,currentPage:1,isDescending:!1,isSearching:!1,ruleDataSource:"",dataSourceMessage:{dataSourceName:"",dataSourceSize:"",dataSourceSpan:"",segmentCount:0,intervalCount:0},preLocation:"",showEnable:!0,dialogType:"info",addRuleForm:[],ruleItemNextId:1,servers:[],dimensions:[],metrics:[],totalMemory:0,freeMemory:0,freePercent:0,segmentsToLoad:0,segmentsToDrop:0,segmentsToLoadSize:0,segmentsToDropSize:0,clusterConfigForm:{}}},created:function(){void 0!==this.$route.query.showEnable&&(this.showEnable=this.$route.query.showEnable),this.init()},methods:{init:function(){this.getMemory(),this.getLoadAndDrop(),this.showEnable?this.getDataSources(this.isDescending,"name",this.formInline.name):this.getDataSourcesDisable(this.isDescending,"name",this.formInline.name)},getClusterConfig:function(){var e=this;return s()(a.a.mark(function t(){var n,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=""+e.$common.apis.clusterConfig,t.next=3,e.$http.get(n);case 3:r=t.sent,e.clusterConfigForm=r.data;case 5:case"end":return t.stop()}},t,e)}))()},editClusterConfig:function(){this.getClusterConfig(),this.dialogType="clusterConfig",this.configDialog(this.$t("message.dataSource.clusterConfig"),"",!0,"small",{minRows:15,maxRows:25})},getLoadAndDrop:function(){var e=this;return s()(a.a.mark(function t(){var n,r,o,s,i,c,u;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=0,r=0,o=0,s=0,i=""+e.$common.apis.loadqueue,t.next=4,e.$http.get(i);case 4:c=t.sent;for(u in c.data)r+=c.data[u].segmentsToLoadSize,n+=c.data[u].segmentsToDropSize,o+=c.data[u].segmentsToLoad,s+=c.data[u].segmentsToDrop;e.segmentsToLoad=o,e.segmentsToDrop=s,e.segmentsToLoadSize=e.$common.methods.conver(r),e.segmentsToDropSize=e.$common.methods.conver(n);case 10:case"end":return t.stop()}},t,e)}))()},getMemory:function(){var e=this;return s()(a.a.mark(function t(){var n,r,o,s,i,c;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=0,r=0,o=0,s=e.$common.apis.serversInfo+"?simple",t.next=4,e.$http.get(s);case 4:for(i=t.sent,c=0;c<i.data.length;c++)r+=i.data[c].maxSize,n+=i.data[c].currSize;o=r-n,e.freeMemory=e.$common.methods.conver(o),e.totalMemory=e.$common.methods.conver(r),e.freePercent=o/r;case 10:case"end":return t.stop()}},t,e)}))()},removeRule:function(e){for(var t=0;t<this.addRuleForm.length;t++)if(this.addRuleForm[t].id===e){this.addRuleForm.splice(t,1);break}},clickSelect:function(e){"dataSourceSelect"===e.name&&this.getDataSources()},addARule:function(){var e={id:this.ruleItemNextId++,inputPrompt:"",actionOptions:[{value:"drop",label:"Drop"},{value:"load",label:"Load"}],actionValue:"",granularityOptions:[{value:"period",label:"Period"},{value:"interval",label:"Interval"},{value:"forever",label:"Forever"}],granularityValue:"",inputMessage:"",number:1,showInput:!1,errorMessage:"",type:"rule"};this.addRuleForm.push(e)},refresh:function(){this.formInline.name="",this.init()},switchChange:function(){this.init()},changeGranularitySelect:function(e){for(var t=0;t<this.addRuleForm.length;t++){var n=this.addRuleForm[t];if(n.id===e){n.inputMessage="","period"===n.granularityValue?(n.inputMessage="P1M",n.showInput=!0,n.inputPrompt=this.$t("message.dataSource.periodInputInfo")):"interval"===n.granularityValue?(n.inputMessage=c()().subtract(1,"months").format()+"/"+c()().format(),n.showInput=!0,n.inputPrompt=this.$t("message.dataSource.intervalInputInfo")):n.showInput=!1,n.type=this.getRuleTypeBySelect(n.actionValue,n.granularityValue);break}}},changeActionSelect:function(e){for(var t=0;t<this.addRuleForm.length;t++){var n=this.addRuleForm[t];n.id===e&&(n.type=this.getRuleTypeBySelect(n.actionValue,n.granularityValue))}},getDataSources:function(e,t,n){var r=this;return s()(a.a.mark(function t(){var o,s,i,c,u,l,m,p,f,d;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.getDataSourcesState();case 2:return o=t.sent,s=r.$common.apis.dataSource+"/sortAndSearch",t.next=6,r.$http.get(s,{params:{simple:!0,isDescending:e,searchValue:r.$common.methods.trim(n)}});case 6:for(i=t.sent,c=0;c<i.data.length;c++)u=i.data[c].properties.segments.size,i.data[c].properties.segments.size=r.$common.methods.conver(u),l=i.data[c].name,m=i.data[c].properties.segments.minTime,p=i.data[c].properties.segments.maxTime,f=new Date(m),d=new Date(p),i.data[c].properties.segments.span=m.substring(0,10)+" / "+p.substring(0,10)+" ( "+r.getDateDiff(f,d)+" )",100==o[l]?i.data[c].statusType="success":i.data[c].statusType="exception",i.data[c].loadstatus=o[l];r.dataSources=[],r.$common.methods.pushData(i.data,r.dataSources),r.showTableData=r.$common.methods.fillShowTableData(r.dataSources,r.currentPage,r.pageSize);case 11:case"end":return t.stop()}},t,r)}))()},getDataSourcesState:function(){var e=this;return s()(a.a.mark(function t(){var n,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.$common.apis.loadstatus,t.next=3,e.$http.get(n);case 3:return r=t.sent,t.abrupt("return",r.data);case 5:case"end":return t.stop()}},t,e)}))()},getDataSourcesDisable:function(e,t,n){var r=this;return s()(a.a.mark(function t(){var o,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=""+r.$common.apis.disableDataSource,t.next=3,r.$http.get(o,{params:{isDescending:e,searchValue:r.$common.methods.trim(n)}});case 3:s=t.sent,r.dataSources=[],r.$common.methods.pushData(s.data,r.dataSources),r.showTableData=r.$common.methods.fillShowTableData(r.dataSources,r.currentPage,r.pageSize);case 7:case"end":return t.stop()}},t,r)}))()},disableDataSource:function(e){var t=this;return s()(a.a.mark(function n(){var r,o,s,i;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=t.$t("message.common.disableWarning")+"\n"+e,o=t.$common.apis.dataSource+"/"+e+"/disable",s=t.$t("message.common.disableSuccess"),i=t.$t("message.common.disableFail"),t.confirmAndGetResult(o,r,s,i,"delete");case 5:case"end":return n.stop()}},n,t)}))()},enableDataSource:function(e){var t=this;return s()(a.a.mark(function n(){var r,o,s,i;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=t.$t("message.common.enableWarning")+"\n"+e,o=t.$common.apis.dataSource+"/"+e+"/enable",s=t.$t("message.common.enableSuccess"),i=t.$t("message.common.enableFail"),t.confirmAndGetResult(o,r,s,i,"post");case 5:case"end":return n.stop()}},n,t)}))()},deleteDataSource:function(e){var t=this;return s()(a.a.mark(function n(){var r,o,s,i;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=t.$t("message.common.deleteWarning")+"\n"+e,o=t.$common.apis.dataSource+"/"+e+"/delete",s=t.$t("message.common.deleteSuccess"),i=t.$t("message.common.deleteFail"),t.confirmAndGetResult(o,r,s,i,"delete");case 5:case"end":return n.stop()}},n,t)}))()},confirmAndGetResult:function(e,t,n,r,o){var i=this;return s()(a.a.mark(function s(){var c,u;return a.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.$confirm(t,i.$t("message.common.warning"),{confirmButtonText:i.$t("message.common.confirm"),cancelButtonText:i.$t("message.common.cancle"),closeOnClickModal:!1,type:"warning"});case 2:if(c=a.sent,a.prev=3,u=void 0,"delete"!==o){a.next=11;break}return a.next=8,i.$http.delete(e);case 8:u=a.sent,a.next=14;break;case 11:return a.next=13,i.$http.post(e);case 13:u=a.sent;case 14:window.setTimeout(i.init,500),i.$message({type:"success",message:n}),a.next=21;break;case 18:a.prev=18,a.t0=a.catch(3),i.$message({type:"warning",message:r});case 21:case"end":return a.stop()}},s,i,[[3,18]])}))()},onSearch:function(){var e=this;return s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.showEnable?e.getDataSources(e.isDescending,"name",e.formInline.name):e.getDataSourcesDisable(e.isDescending,"name",e.formInline.name);case 1:case"end":return t.stop()}},t,e)}))()},getDimensions:function(e){var t=this;return s()(a.a.mark(function n(){var r;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.$common.apis.clientInfo+"/"+e+"/dimensions",n.next=3,t.putArrayDataFromUrl(r);case 3:t.dimensions=n.sent;case 4:case"end":return n.stop()}},n,t)}))()},getMetrics:function(e){var t=this;return s()(a.a.mark(function n(){var r;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.$common.apis.clientInfo+"/"+e+"/metrics",n.next=3,t.putArrayDataFromUrl(r);case 3:t.metrics=n.sent;case 4:case"end":return n.stop()}},n,t)}))()},getServers:function(e){var t=this;return s()(a.a.mark(function n(){var r;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.$common.apis.serversInfo+"/datasources/"+e,n.next=3,t.putArrayDataFromUrl(r);case 3:t.servers=n.sent;case 4:case"end":return n.stop()}},n,t)}))()},routeToServer:function(e){this.$router.push({name:"serversSegment",params:{serverName:e},query:{source:"dataSource"}})},putArrayDataFromUrl:function(e){var t=this;return s()(a.a.mark(function n(){var r;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.$http.get(e);case 2:return r=n.sent,0===r.data.length&&(r.data[0]=t.$t("message.common.none")),n.abrupt("return",r.data);case 5:case"end":return n.stop()}},n,t)}))()},getRuleHistory:function(e){var t=this.$common.apis.rules+"/"+e+"/history";this.getInfoFromUrl(t,this.$t("message.dataSource.rulesHistory"))},getClusterHistory:function(){var e=this.$common.apis.clusterConfig+"/history";this.getInfoFromUrl(e,this.$t("message.dataSource.clusterConfigHistory"))},getInfoFromUrl:function(e,t){var n=this;return s()(a.a.mark(function r(){var o,s;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.$http.get(e);case 2:o=r.sent,s=n.$common.methods.JSONUtils.toString(o.data),n.dialogType="info",n.configDialog(t,s,!0,"small",{minRows:15,maxRows:25});case 6:case"end":return r.stop()}},r,n)}))()},getRuleInfo:function(e){var t=this;return s()(a.a.mark(function n(){var r,o,s,i;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.$common.apis.rules+"/"+e,n.next=3,t.$http.get(r);case 3:for(o=n.sent,s=0;s<o.data.length;s++)i=t.getRuleItemFromInfo(o.data[s]),t.addRuleForm.push(i);case 5:case"end":return n.stop()}},n,t)}))()},getRuleItemFromInfo:function(e){var t=void 0,n=void 0,r=void 0,a=1,o=void 0,s=e.type;return s.indexOf("drop")>-1?t="drop":s.indexOf("load")>-1?(t="load",a=e.tieredReplicants._default_tier):t="broadcast",s.indexOf("Period")>-1?(r="period",n=!0,o=e.period):s.indexOf("Interval")>-1?(r="interval",n=!0,o=e.interval):(r="forever",n=!1),{id:this.ruleItemNextId++,type:s,actionValue:t,granularityValue:r,inputMessage:o,number:a,showInput:n,inputPrompt:"",errorMessage:"",actionOptions:[{value:"drop",label:"Drop"},{value:"load",label:"Load"}],granularityOptions:[{value:"period",label:"Period"},{value:"interval",label:"Interval"},{value:"forever",label:"Forever"}]}},editRule:function(e){this.addRuleForm=[],this.ruleItemNextId=1,this.getRuleInfo(e),this.ruleDataSource=e,this.dialogType="editRule",this.configDialog(this.$t("message.dataSource.rulesInfo"),"",!0,"small",{minRows:15,maxRows:25})},configDialog:function(e,t,n,r,a){this.dialogTitle=e,this.dialogMessage=t,this.dialogVisible=n,this.dialogSize=r,this.dialogInputAutosize=a},getSegments:function(e){this.getDataSourceMessageFromRow(e),this.$router.push({path:"/segment",query:{preLocation:"dataSource",showEnable:this.showEnable,dataSourceName:this.dataSourceMessage.dataSourceName,dataSourceSize:this.dataSourceMessage.dataSourceSize,segmentCount:this.dataSourceMessage.segmentCount,intervalCount:this.dataSourceMessage.intervalCount,dataSourceSpan:this.dataSourceMessage.dataSourceSpan}})},getIntervals:function(e){this.getDataSourceMessageFromRow(e),this.$router.push({path:"/interval",query:{showEnable:this.showEnable,preLocation:"dataSource",dataSourceName:this.dataSourceMessage.dataSourceName,dataSourceSize:this.dataSourceMessage.dataSourceSize,segmentCount:this.dataSourceMessage.segmentCount,intervalCount:this.dataSourceMessage.intervalCount,dataSourceSpan:this.dataSourceMessage.dataSourceSpan}})},getDataSourceMessageFromRow:function(e){this.dataSourceMessage.dataSourceName=e.name,this.showEnable&&(this.dataSourceMessage.dataSourceSize=e.properties.segments.size,this.dataSourceMessage.segmentCount=e.properties.segments.count,this.dataSourceMessage.intervalCount=e.properties.segments.intervalCount,this.dataSourceMessage.dataSourceSpan=e.properties.segments.span)},getIntervalCount:function(e){var t=this;return s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,t)}))()},getDateDiff:function(e,t){var n=t.getTime()-e.getTime(),r=Math.floor(n/31536e6);if(r>0)return r+this.addS(r," year");var a=Math.floor(n/26352e5);if(a>0)return a+this.addS(a," month");var o=Math.floor(n/864e5);if(o>0)return o+this.addS(o," day");var s=Math.floor(n/36e5);if(s>0)return s+this.addS(s," hour");var i=Math.floor(n/6e4);if(i>0)return i+this.addS(i," minute");var c=Math.floor(n/1e3);return c+this.addS(c," second")},addS:function(e,t){return e>1&&(t+="s"),t},handleCurrentChange:function(e){this.currentPage=e,this.showTableData=this.$common.methods.fillShowTableData(this.dataSources,this.currentPage,this.pageSize)},handleSizeChange:function(e){this.pageSize=e,this.showTableData=this.$common.methods.fillShowTableData(this.dataSources,this.currentPage,this.pageSize)},handleSort:function(e){this.isDescending="descending"===e.order,this.showEnable?this.getDataSources(this.isDescending,e.prop,this.formInline.name):this.getDataSourcesDisable(this.isDescending,e.prop,this.formInline.name)},clickConfirm:function(){"editRule"===this.dialogType?this.checkRuleInfo()&&(this.addRule(),this.dialogVisible=!1):"clusterConfig"===this.dialogType?this.updateClusterConfig():this.dialogVisible=!1},updateClusterConfig:function(){console.log(this.clusterConfigForm)},checkRuleInfo:function(){for(var e=0;e<this.addRuleForm.length;e++){var t=this.addRuleForm[e];if(""===t.actionValue)return t.errorMessage=this.$t("message.error.chooseAction"),!1;if(""===t.granularityValue)return t.errorMessage=this.$t("message.error.chooseGranularity"),!1;if(t.showInput&&0===t.inputMessage.length)return t.errorMessage=t.granularityValue+this.$t("message.error.canNotBeNull"),!1;t.errorMessage=""}return!0},addRule:function(){var e=this;return s()(a.a.mark(function t(){var n,r,o,s,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.$t("message.dataSource.addRuleWarning"),r=e.getInputRule(),t.next=4,e.$confirm(n,e.$t("message.common.warning"),{confirmButtonText:e.$t("message.common.confirm"),cancelButtonText:e.$t("message.common.cancle"),closeOnClickModal:!1,type:"warning"});case 4:return o=t.sent,t.prev=5,s=e.$common.apis.rules+"/"+e.ruleDataSource,t.next=9,e.$http.post(s,r,{header:{ContentType:"application/json"}});case 9:i=t.sent,window.setTimeout(e.init,500),e.$message({type:"success",message:e.$t("message.dataSource.addRulesSuccess")}),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(5),e.$message({type:"warning",message:e.$t("message.dataSource.addRulesFail")});case 17:case"end":return t.stop()}},t,e,[[5,14]])}))()},getInputRule:function(){for(var e=new Array,t=0;t<this.addRuleForm.length;t++){var n=this.addRuleForm[t],r={};if("load"===n.actionValue){var a={};a._default_tier=n.number,r.tieredReplicants=a}"interval"===n.granularityValue?(r.type=n.actionValue+"ByInterval",r.interval=n.inputMessage):"period"===n.granularityValue?(r.type=n.actionValue+"ByPeriod",r.period=n.inputMessage):r.type=n.actionValue+"Forever",e.push(r)}return e},getRuleTypeBySelect:function(e,t){return""!==e&&""!==t&&void 0!==t?"interval"===t?e+"ByInterval":"period"===t?e+"ByPeriod":e+"Forever":"rule"},getDataSourceByName:function(e){var t=this;return s()(a.a.mark(function n(){var r,o,s;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.$common.apis.dataSource+"/"+e+"?full",n.next=3,t.$http.get(r);case 3:o=n.sent,t.dataSources=[],s=new Array,s[0]=o.data,t.$common.methods.pushData(s,t.dataSources),t.showTableData=t.$common.methods.fillShowTableData(t.dataSources,t.currentPage,t.pageSize);case 9:case"end":return n.stop()}},n,t)}))()}}}},701:function(e,t,n){t=e.exports=n(89)(void 0),t.i(n(654),""),t.i(n(655),""),t.push([e.i,".el-progress-circle svg path:first-child{stroke:#c6c6c6}.ruleTypeDiv{color:#20a0ff;font-size:18px;line-height:22px;font-weight:700}.el-progress.is-exception .el-progress-bar__inner{background-color:#13ce66}.el-progress-bar__outer{background-color:#c6c6c6}.progress-div{width:550px;position:relative;top:9px}.info-div{position:relative;top:15px;color:#20a0ff;font-size:14px}.total-memory-span{position:relative;left:265px}.load-span{position:relative;left:400px}.drop-span{position:relative;left:500px}.edit-span{position:relative;left:550px}.search-div{position:relative;top:10px}",""])},731:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"main"},[n("div",{staticStyle:{"margin-left":"20px"}},[n("span",{staticStyle:{color:"#242f42","font-size":"20px"}},[n("el-breadcrumb",{attrs:{separator:">"}},[n("el-breadcrumb-item",{attrs:{to:{path:"/dataSource",query:{showEnable:this.showEnable}}}},[e._v(e._s(e.$t("message.dataSource.dataSourceTitle")))])],1)],1),e._v(" "),n("div",{staticClass:"info-div"},[n("span",[e._v("Free Memory : "+e._s(this.freeMemory))]),e._v(" "),n("span",{staticClass:"total-memory-span"},[e._v("Total Memory : "+e._s(this.totalMemory))]),e._v(" "),n("span",{staticClass:"load-span"},[e._v(e._s(this.segmentsToLoadSize)+" ("+e._s(this.segmentsToLoad)+" segments) to load")]),e._v(" "),n("span",{staticClass:"drop-span"},[e._v(e._s(this.segmentsToDropSize)+" ("+e._s(this.segmentsToDrop)+" segments) to drop")]),e._v(" "),n("span",{staticClass:"edit-span"},[n("el-button",{attrs:{size:"mini",icon:"time"},on:{click:e.getClusterHistory}})],1)]),e._v(" "),n("div",{staticClass:"progress-div"},[n("el-progress",{attrs:{"text-inside":!0,"stroke-width":3,percentage:100*this.freePercent,status:"exception"}})],1),e._v(" "),n("div",{staticClass:"search-div"},[n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[n("el-form-item",{attrs:{label:e.$t("message.common.name")}},[n("el-input",{attrs:{placeholder:e.$t("message.common.inputName"),size:"small"},model:{value:e.formInline.name,callback:function(t){e.formInline.name=t},expression:"formInline.name"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"small",icon:"search"},on:{click:e.onSearch}},[e._v(e._s(e.$t("message.common.search")))]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.refresh}},[e._v(e._s(e.$t("message.common.refresh")))]),e._v(" "),n("el-switch",{staticStyle:{position:"absolute",left:"1100px",top:"18px"},attrs:{"on-color":"#13ce66","off-color":"#ff4949","on-text":"Enable","off-text":"Disable",width:80},on:{change:e.switchChange},model:{value:e.showEnable,callback:function(t){e.showEnable=t},expression:"showEnable"}},[e._v(">\n          ")])],1)],1)],1)]),e._v(" "),n("div",{staticClass:"table",staticStyle:{"margin-left":"20px"}},[n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.showTableData,border:"",stripe:""},on:{"sort-change":e.handleSort}},[n("el-table-column",{attrs:{label:e.$t("message.common.name"),sortable:"custom",width:330},scopedSlots:e._u([{key:"default",fn:function(t){return[e.showEnable?n("el-progress",{attrs:{type:"circle",percentage:t.row.loadstatus,width:10,"show-text":!1,"stroke-width":2,status:t.row.statusType}}):e._e(),e._v(" "),n("a",{staticClass:"click-link",on:{click:function(n){e.getIntervals(t.row)}}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),e.showEnable?n("el-table-column",{attrs:{prop:"properties.segments.count",label:e.$t("message.dataSource.segmentCount"),width:"140"}}):e._e(),e._v(" "),e.showEnable?n("el-table-column",{attrs:{prop:"properties.segments.intervalCount",label:e.$t("message.dataSource.intervalCount"),width:"140"}}):e._e(),e._v(" "),e.showEnable?n("el-table-column",{attrs:{prop:"properties.segments.size",label:e.$t("message.common.size"),width:"105"}}):e._e(),e._v(" "),e.showEnable?n("el-table-column",{attrs:{prop:"properties.segments.span",label:e.$t("message.dataSource.span"),width:"280"}}):e._e(),e._v(" "),n("el-table-column",{attrs:{label:e.$t("message.dataSource.rules"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",icon:"edit"},on:{click:function(n){e.editRule(t.row.name)}}}),e._v(" "),n("el-button",{attrs:{size:"mini",icon:"time"},on:{click:function(n){e.getRuleHistory(t.row.name)}}})]}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$t("message.common.more")},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(n){e.getSegments(t.row)}}},[e._v(e._s(e.$t("message.dataSource.segments")))]),e._v(" "),e.showEnable?[n("el-popover",{ref:"popoverServer",attrs:{placement:"right",width:"150",trigger:"click"}},e._l(e.servers,function(t){return n("div",{key:t,staticClass:"popoverDiv"},[n("a",{staticClass:"click-link",on:{click:function(n){e.routeToServer(t)}}},[e._v(e._s(t))])])})),e._v(" \n            "),n("el-button",{directives:[{name:"popover",rawName:"v-popover:popoverServer",arg:"popoverServer"}],attrs:{size:"mini"},on:{click:function(n){e.getServers(t.row.name)}}},[e._v(e._s(e.$t("message.dataSource.servers")))]),e._v(" "),n("el-popover",{ref:"popoverDimension",attrs:{placement:"right",width:"150",trigger:"click"}},e._l(e.dimensions,function(t){return n("div",{key:t,staticClass:"popoverDiv"},[e._v(e._s(t))])})),e._v(" \n            "),n("el-button",{directives:[{name:"popover",rawName:"v-popover:popoverDimension",arg:"popoverDimension"}],attrs:{size:"mini"},on:{click:function(n){e.getDimensions(t.row.name)}}},[e._v(e._s(e.$t("message.dataSource.dimensions")))]),e._v(" "),n("el-popover",{ref:"popoverMetric",attrs:{placement:"right",width:"150",trigger:"click"}},e._l(e.metrics,function(t){return n("div",{key:t,staticClass:"popoverDiv"},[e._v(e._s(t))])})),e._v(" \n            "),n("el-button",{directives:[{name:"popover",rawName:"v-popover:popoverMetric",arg:"popoverMetric"}],attrs:{size:"mini"},on:{click:function(n){e.getMetrics(t.row.name)}}},[e._v(e._s(e.$t("message.dataSource.metrics")))])]:e._e(),e._v(" "),e.showEnable?n("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(n){e.disableDataSource(t.row.name)}}},[e._v(e._s(e.$t("message.common.disable")))]):e._e(),e._v(" "),e.showEnable?e._e():n("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(n){e.enableDataSource(t.row.name)}}},[e._v(e._s(e.$t("message.common.enable")))]),e._v(" "),e.showEnable?e._e():n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){e.deleteDataSource(t.row.name)}}},[e._v(e._s(e.$t("message.common.delete")))])]}}])})],1),e._v(" "),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15,25,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.dataSources.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogVisible,size:e.dialogSize},on:{"update:visible":function(t){e.dialogVisible=t},close:function(t){e.dialogMessage=""}}},[n("template",{attrs:{slot:"title"},slot:"title"},[n("div",{staticStyle:{"line-height":"1","font-size":"16px","font-weight":"700",color:"#1f2d3d"}},[e._v("\n        "+e._s(e.dialogTitle)+"\n      ")])]),e._v(" "),"info"===e.dialogType?n("el-input",{attrs:{type:"textarea",autosize:e.dialogInputAutosize},model:{value:e.dialogMessage,callback:function(t){e.dialogMessage=t},expression:"dialogMessage"}}):e._e(),e._v(" "),e._l(e.addRuleForm,function(t){return"editRule"===e.dialogType?n("el-form",{key:t.id,attrs:{inline:!0,model:t}},[n("div",{staticClass:"ruleTypeDiv"},[e._v("\n        "+e._s(t.type)+"\n        "),n("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",icon:"delete"},on:{click:function(n){e.removeRule(t.id)}}}),n("br"),n("br")],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("message.dataSource.operate")}},[n("el-select",{attrs:{placeholder:e.$t("message.dataSource.operateInfo"),size:"20"},on:{change:function(n){e.changeActionSelect(t.id)}},model:{value:t.actionValue,callback:function(e){t.actionValue=e},expression:"ruleItem.actionValue"}},e._l(t.actionOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("message.dataSource.granularity")}},[n("el-select",{attrs:{placeholder:e.$t("message.dataSource.granularityInfo"),size:"20"},on:{change:function(n){e.changeGranularitySelect(t.id)}},model:{value:t.granularityValue,callback:function(e){t.granularityValue=e},expression:"ruleItem.granularityValue"}},e._l(t.granularityOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),n("div",[t.showInput?n("el-form-item",{attrs:{label:t.granularityValue}},[n("el-input",{attrs:{placeholder:t.inputPrompt,size:"45"},model:{value:t.inputMessage,callback:function(e){t.inputMessage=e},expression:"ruleItem.inputMessage"}})],1):e._e(),e._v(" "),"load"===t.actionValue?n("el-form-item",{attrs:{label:"_default_tier"}},[n("el-input-number",{attrs:{min:1,max:100},model:{value:t.number,callback:function(e){t.number=e},expression:"ruleItem.number"}})],1):e._e()],1),e._v(" "),n("div",[n("div",{staticStyle:{color:"red",position:"relative",top:"-15px","font-size":"13px"}},[e._v(e._s(t.errorMessage))])])],1):e._e()}),e._v(" "),"clusterConfig"===e.dialogType?n("el-form",{attrs:{model:e.clusterConfigForm,"label-width":"200px"}},[n("el-form-item",{attrs:{label:"balancerComputeThreads"}},[n("el-input-number",{attrs:{min:1,max:100},model:{value:e.clusterConfigForm.balancerComputeThreads,callback:function(t){e.clusterConfigForm.balancerComputeThreads=t},expression:"clusterConfigForm.balancerComputeThreads"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"maxSegmentsToMove"}},[n("el-input-number",{attrs:{min:1,max:100},model:{value:e.clusterConfigForm.maxSegmentsToMove,callback:function(t){e.clusterConfigForm.maxSegmentsToMove=t},expression:"clusterConfigForm.maxSegmentsToMove"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"mergeBytesLimit"}},[n("el-input-number",{attrs:{min:1,max:100},model:{value:e.clusterConfigForm.mergeBytesLimit,callback:function(t){e.clusterConfigForm.mergeBytesLimit=t},expression:"clusterConfigForm.mergeBytesLimit"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"mergeSegmentsLimit"}},[n("el-input-number",{attrs:{min:1,max:100},model:{value:e.clusterConfigForm.mergeSegmentsLimit,callback:function(t){e.clusterConfigForm.mergeSegmentsLimit=t},expression:"clusterConfigForm.mergeSegmentsLimit"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"millisToWaitBeforeDeleting"}},[n("el-input-number",{attrs:{min:1,max:100},model:{value:e.clusterConfigForm.millisToWaitBeforeDeleting,callback:function(t){e.clusterConfigForm.millisToWaitBeforeDeleting=t},expression:"clusterConfigForm.millisToWaitBeforeDeleting"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"replicantLifetime"}},[n("el-input-number",{attrs:{min:1,max:100},model:{value:e.clusterConfigForm.replicantLifetime,callback:function(t){e.clusterConfigForm.replicantLifetime=t},expression:"clusterConfigForm.replicantLifetime"}})],1)],1):e._e(),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["editRule"===e.dialogType?n("el-button",{attrs:{type:"warning",icon:"plus"},on:{click:e.addARule}}):e._e(),e._v(" "),"info"!==e.dialogType?n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(e._s(e.$t("message.common.cancle")))]):e._e(),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.clickConfirm()}}},[e._v(e._s(e.$t("message.common.confirm")))])],1)],2)],1)},staticRenderFns:[]}},756:function(e,t,n){var r=n(701);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);n(317)("f86d2e7e",r,!0)}});